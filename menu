local library = loadstring(game:HttpGet("https://raw.githubusercontent.com/dawid-scripts/UI-Libs/main/Vape.txt"))()

local window = library:Window("Player Controller", Color3.fromRGB(44, 120, 224), Enum.KeyCode.RightControl)
local mainTab = window:Tab("Main")

local controlledPlayer = nil
local isControlling = false
local originalCFrame = nil

local function controlPlayer(player)
    if controlledPlayer and controlledPlayer.Character and controlledPlayer.Character:FindFirstChild("HumanoidRootPart") then
        game.Players.LocalPlayer.Character.HumanoidRootPart.CFrame = originalCFrame
    end
    
    if player and player.Character and player.Character:FindFirstChild("HumanoidRootPart") then
        originalCFrame = game.Players.LocalPlayer.Character.HumanoidRootPart.CFrame
        game.Players.LocalPlayer.Character.HumanoidRootPart.CFrame = player.Character.HumanoidRootPart.CFrame
        controlledPlayer = player
        isControlling = true
        return true
    end
    return false
end

local function stopControl()
    if controlledPlayer and originalCFrame then
        game.Players.LocalPlayer.Character.HumanoidRootPart.CFrame = originalCFrame
        controlledPlayer = nil
        isControlling = false
        originalCFrame = nil
    end
end

local playerList = {}
for _, player in pairs(game.Players:GetPlayers()) do
    if player ~= game.Players.LocalPlayer then
        table.insert(playerList, player.Name)
    end
end

mainTab:Toggle("Control Player", false, function(state)
    if state then
        window:Notification("Control Player", "Select a player to control from the dropdown list", "Okay")
    else
        stopControl()
    end
end)

mainTab:Dropdown("Select Player", playerList, function(selectedPlayerName)
    if isControlling then
        local player = game.Players:FindFirstChild(selectedPlayerName)
        if player then
            controlPlayer(player)
        end
    end
end)
